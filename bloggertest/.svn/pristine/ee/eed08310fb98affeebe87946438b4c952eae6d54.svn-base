<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="description"
	content="A fully featured admin theme which can be used to build CRM, CMS, etc.">
<meta name="author" content="Coderthemes">

<link rel="shortcut icon" href="../../img/favicon_1.ico"
	th:src="@{static/img/favicon_1.ico}">

<title>我的设置</title>

<link href="../../css/bootstrap.min.css"
	th:href="@{static/css/bootstrap.min.css}" rel="stylesheet"
	type="text/css">
<link href="../../css/setcore.css" th:href="@{static/css/setcore.css}"
	rel="stylesheet" type="text/css">
<link href="../../css/icons.css" th:href="@{static/css/icons.css}"
	rel="stylesheet" type="text/css">
<link href="../../css/components.css"
	th:href="@{static/css/components.css}" rel="stylesheet" type="text/css">
<link href="../../css/pages.css" th:href="@{static/css/pages.css}"
	rel="stylesheet" type="text/css">
<link href="../../css/menu.css" th:href="@{static/css/menu.css}"
	rel="stylesheet" type="text/css">
<link href="../../css/responsive.css"
	th:href="@{static/css/responsive.css}" rel="stylesheet" type="text/css">
<link href="../../font-awesome-4.7.0/css/font-awesome.min.css"
	th:href="@{static/font-awesome-4.7.0/css/font-awesome.min.css}"
	rel="stylesheet">
<link href="../../css/changeUserInfor.css"
	th:href="@{static/css/changeUserInfor.css}" rel="stylesheet"
	type="text/css">
<link rel="stylesheet" href="../../css/cropper.min.css"
	th:href="@{static/css/cropper.min.css}">
<link rel="stylesheet" href="../../css/ImgCropping.css"
	th:href="@{static/css/ImgCropping.css}">
<link rel="stylesheet" type="text/css" href="../../css/build.css"
	th:href="@{static/css/build.css}">
<link rel="stylesheet" type="text/css" href="../../css/alert.css"
	th:href="@{static/css/alert.css}">
<link href="../../css/gloab.css" th:href="@{static/css/gloab.css}"
	rel="stylesheet">
<script src="../../js/jquery.min.js" th:src="@{static/js/jquery.min.js}"></script>
<script src="../../js/modernizr.min.js"
	th:src="@{static/js/modernizr.min.js}"></script>
<script type="text/javascript" src="../../js/register.js"
	th:src="@{static/js/register.js}"></script>
</head>

<body class="fixed-left">

	<!-- 大的页面 -->
	<div id="wrapper">

		<!-- 导航栏开始 -->
		<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<div class="text-center">
						<a href="toindex" class="logo"><img src="../../img/logo.png" th:src="@{static/img/logo.png}" width="60px" /><span>飞马测试 </span></a>
					</div>
				</div>

				<div class="navbar navbar-default" role="navigation">
					<div class="container">
						<div class="">
							<div class="pull-left">
								<button class="button-menu-mobile open-left">
                                    <i class="fa fa-bars"></i>
                                </button>
								<span class="clearfix"></span>
							</div>
							<ul class="nav navbar-nav navbar-left pull-left">
							
								<li th:if="${session.currentUser.usertype != null} and ${session.currentUser.usertype==0}" class="hidden-xs">
									<a th:href="toStudentPaperIndex" id="" class="waves-effect"><i class="glyphicon glyphicon-education nvaIcon"></i>试卷</a>
								</li>
								<li th:if="${session.currentUser.usertype != null} and ${session.currentUser.usertype==1}" class="hidden-xs">
									<a th:href="tounpublishteacherPaper" id="" class="waves-effect"><i class="glyphicon glyphicon-education nvaIcon"></i>试卷</a>
								</li>
								<li th:if="${session.currentUser.usertype != null} and ${session.currentUser.usertype==1}" class="hidden-xs">
									<a th:href="tobankTeacher" id="" class="waves-effect"><i class="glyphicon glyphicon-folder-open nvaIcon"></i>题库</a>
								</li>
								<li class="hidden-xs">
									<a th:href="toGroup" id="" class="waves-effect"><i class="fa fa-users nvaIcon"></i>群组</a>
								</li>
								<li th:if="${session.currentUser.usertype != null} and ${session.currentUser.usertype==0}" class="hidden-xs">
									<a th:href="topapershop"  id="" class="waves-effect"><i class="fa fa-shopping-basket nvaIcon"></i>试卷商城</a>
								</li>
								<li th:if="${session.currentUser.usertype != null} and ${session.currentUser.usertype==1}" class="hidden-xs">
									<a th:href="tobankshop" id="" class="waves-effect"><i class="fa fa-shopping-basket nvaIcon"></i>题库商城</a>
								</li>
							</ul>
							<ul class="nav navbar-nav navbar-right pull-right">
								<li class="dropdown hidden-xs">
									<a href="#" data-target="#" class="dropdown-toggle waves-effect" data-toggle="dropdown" aria-expanded="true">
										<i class="md md-notifications"></i> <span class="badge badge-xs badge-danger">3</span>
									</a>
									<ul class="dropdown-menu dropdown-menu-lg">
										<li class="text-center notifi-title">通知</li>

										<li class="list-group">
											<!-- list item-->
											<a th:href="inform" class="list-group-item">
												<div class="media">
													<div class="pull-left">
														<em class="fa fa-user-plus fa-2x text-info"></em>
													</div>
													<div class="media-body clearfix">
														<div class="media-heading">New user registered</div>
														<p class="m-0">
															<small>You have 10 unread messages</small>
														</p>
													</div>
												</div>
											</a>
											<!-- list item-->
											<a th:href="inform" class="list-group-item">
												<div class="media">
													<div class="pull-left">
														<em class="fa fa-diamond fa-2x text-primary"></em>
													</div>
													<div class="media-body clearfix">
														<div class="media-heading">New settings</div>
														<p class="m-0">
															<small>There are new settings available</small>
														</p>
													</div>
												</div>
											</a>
											<!-- list item-->
											<a th:href="inform" class="list-group-item">
												<div class="media">
													<div class="pull-left">
														<em class="fa fa-bell-o fa-2x text-danger"></em>
													</div>
													<div class="media-body clearfix">
														<div class="media-heading">Updates</div>
														<p class="m-0">
															<small>There are
                                                          <span class="text-primary">2</span> new updates available</small>
														</p>
													</div>
												</div>
											</a>
											<!-- last list item -->
											<a th:href="inform" class="list-group-item">
												<small>See all notifications</small>
											</a>
										</li>
									</ul>
								</li>

								<li class="hidden-xs">
									<a href="#" id="btn-fullscreen" class="waves-effect"><i class="md md-crop-free"></i></a>
								</li>
								<li class="hidden-xs">
									<a href="#" class="right-bar-toggle waves-effect"><i class="md md-chat"></i></a>
								</li>
								<li class="dropdown">
									<a href="" class="dropdown-toggle profile" data-toggle="dropdown" aria-expanded="true"><img src="../../img/defalutIcon.png" th:src="@{static/img/defalutIcon.png}" alt="user-img" class="img-circle"> </a>
									<ul class="dropdown-menu">
										<li>
											<a th:href="toExamEntrance"><i class="fa fa-pencil nvaIcon2"></i> 考试入口</a>
										</li>
										<li>
											<a th:href="tochangeUserInfor"><i class="md md-settings nvaIcon2"></i> 我的设置</a>
										</li>
										<li>
											<a th:href="switchIdentity"><i class="fa fa-exchange nvaIcon2"></i> 切换身份</a>
										</li>
										<li>
											<a href="toLogout"><i class="md md-settings-power nvaIcon2"></i> 退出登录</a>
										</li>
									</ul>
								</li>
								<li class="hidden-xs">
									<a th:href="switchIdentity" class="waves-effect"><i class="fa fa-exchange"></i></a>
								</li>
							</ul>
						</div>
						<!--用户选项 -->
					</div>
				</div>
			</div>
	   	
		<!-- 导航栏结束 -->

		<div class="left side-menu">
			<div class="sidebar-inner slimscrollleft">
				<div class="user-details">
					<div class="pull-left">
						<img src="../../img/defalutIcon.png"
							th:src="@{static/img/defalutIcon.png}" alt=""
							class="thumb-md img-circle">
					</div>
					<div class="user-info">
						<div class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown"
								aria-expanded="false">用户姓名</a>

						</div>

						<p class="text-muted m-0">用户账号</p>
					</div>
				</div>
				<!--- Divider -->
				<div id="sidebar-menu">
					<ul>

						<li class="has_sub"><a class="waves-effect waves-light active"><i
								class="glyphicon glyphicon-user"></i><span>个人资料</span><span
								class="pull-right"><i class="md md-remove"></i></span></a>
							<ul class="list-unstyled">
								<li class="active"><a href="tochangeUserInfor"><i
										class="glyphicon glyphicon-list-alt"></i>基本信息</a></li>
								<li><a href="tochangePassword"><i
										class="glyphicon glyphicon-edit"></i>修改密码</a></li>
							</ul></li>
						<li class="has_sub"><a class="waves-effect waves-light"><i
								class="glyphicon glyphicon-home"></i><span>公司资料</span><span
								class="pull-right"><i class="md md-add"></i></span></a>
							<ul>
								<li><a href="tochangeCompany"><i
										class="glyphicon glyphicon-list-alt"></i>基本信息</a></li>
							</ul></li>
					</ul>
					<div class="clearfix"></div>
				</div>
				<div class="clearfix"></div>
			</div>
		</div>
		<!-- 左边bar结束 -->

		<!-- ============================================================== -->
		<!-- 中间信息显示开始 ->
			<!-- ============================================================== -->
		<div class="content-page">
			<!-- 内容开始 -->
			<div class="content">
				<div class="container">

					<!-- 页面名称 -->
					<div class="row">
						<div class="col-sm-12">
							<h4 class="pull-left page-title">
								<span
									style="color: green; background-color: green; width: 10px; margin-right: 15px;"><b>|</b></span>个人基本信息
							</h4>
						</div>
					</div>

					<!-- 页面详情-->
					<div style="height: 575px; background: #FFFFFF;">
						<div class="inforContainer">
							<div class="user-photo">

								<div class="infortitle">
									<h5>
										<b>用户头像</b>
									</h5>
								</div>
								<div class="photo-editor">

									<img id="finalImg" src="../../img/defalutIcon.png"
										th:src="@{static/img/defalutIcon.png}" />
									<h6 style="display: inline;">
										点击头像可进行编辑&nbsp;<b>|</b>&nbsp;支持jpg、jpeg、png格式
									</h6>
									<!-- 							<form action="userEditorTouxiangServlet" method="post" enctype="multipart/form-data"> -->
									<input type="file" accept="image/jpg,image/jpeg,image/png"
										id="upload-userPhoto" onChange="selectImgupload(this)" />
									<!-- 							<input type="submit" value="上传" /> -->
									<!-- 							</form> -->
									<div class="photo-mask">
										<a><b>编辑</b></a>
									</div>

								</div>

							</div>

							<div class="reg-box" id="verifyCheck">

								<div class="item col-xs-12">
									<div class=" intelligent-label f-fl">
										<b class="ftx04">*</b>
										<h5>
											<b>真实姓名</b>
										</h5>
									</div>

									<div class="f-fl item-ifo">
										<input value="刘璐" type="text" maxlength="10"
											class="txt03 f-r3 required" tabindex="1"
											data-valid="isNonEmpty||between:2-10||isZh"
											data-error="真实姓名不能为空||真实姓名长度2-10位||只能输入中文" id="adminNo" /> <span
											class="ie8 icon-close close hide"></span> <label
											class="icon-sucessfill blank hide" style="z-index: 999;">

											<div id="namesaveIcon" style="display: inline;">
												<span class="fa fa-check" style="margin-left: 10px;"></span>
											</div>
											<div id="namenosaveIcon" style="display: inline;">
												<span class="fa fa-times" style="margin-left: 10px;"></span>
											</div> <!--<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>-->
										</label> <label class="focus" style="display: none;">2-10位，中文真实姓名</label>
										<label class="focus valid"></label>
									</div>

								</div>

								<div class="item col-xs-12">
									<div class=" intelligent-label f-fl">
										<b class="ftx04">*</b>
										<h5>
											<b>登录账号</b>
										</h5>
									</div>

									<div class="f-fl item-ifo">
										<input type="text" id="" value="系统中用户账号"
											class="txt03 f-r3 required" disabled />
										<!-- <input type="text" id="input-tel" class="txt03 f-r3 required" keycodes="tel" tabindex="2" data-valid="isNonEmpty||isPhone" data-error="手机号码不能为空||手机号码格式不正确" maxlength="11" id="phone" /> -->
										<span class="ie8 icon-close close hide"></span> <label
											class="icon-sucessfill blank hide"><span
											class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span></label>
										<label class="focus">此为注册时系统自动生成的登录账号，不可更改</label> <label
											class="focus valid"></label>
									</div>
								</div>
								<div class="item col-xs-12">
									<div class=" intelligent-label f-fl">
										<b class="ftx04">*</b>
										<h5>
											<b>手机号</b>
										</h5>
									</div>

									<div class="f-fl item-ifo">
										<input type="text" value="13398165338" id="input-tel"
											class="txt03 f-r3 required" keycodes="tel" tabindex="2"
											data-valid="isNonEmpty||isPhone"
											data-error="手机号码不能为空||手机号码格式不正确" maxlength="11" />
										<!-- <input type="text" id="input-tel" class="txt03 f-r3 required" keycodes="tel" tabindex="2" data-valid="isNonEmpty||isPhone" data-error="手机号码不能为空||手机号码格式不正确" maxlength="11" id="phone" /> -->
										<span class="ie8 icon-close close hide"></span> <label
											class="icon-sucessfill blank hide">
											<div class="item col-xs-12" id="rightSend"
												style="width: auto;">
												<div class="f-fl item-ifo">
													<span id="" class="btn btn-gray f-r3 f-ml5 f-size13"
														style="margin-left: 10px;">确认发送验证码</span>
												</div>
											</div> <!--<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>-->
										</label> <label class="focus" style="display: none;">请填写11位有效的手机号码,注意手机号不可重复注册</label>
										<label class="focus valid"></label>
									</div>
								</div>
								<div class="item col-xs-12" id="verifydiv"
									style="display: none;">
									<div class=" intelligent-label f-fl">
										<b class="ftx04">*</b>
										<h5>
											<b>验证码</b>
										</h5>
									</div>
									<div class="f-fl item-ifo">
										<input type="text" maxlength="6" id="verifyNo"
											class="txt03 f-r3 f-fl required" tabindex="4"
											style="width: 167px" data-valid="isNonEmpty||isInt"
											data-error="验证码不能为空||请输入6位数字验证码" /> <label
											class="icon-sucessfill blank hide">
											<div id="verifysaveIcon" title="确定" style="display: inline;">
												<span class="fa fa-check" style="margin-left: 10px;"></span>
											</div>
											<div id="verifynosaveIcon" title="取消"
												style="display: inline;">
												<span class="fa fa-times" style="margin-left: 10px;"></span>
											</div>
										</label> <span id="sendBtn"
											class="msgs btn btn-gray f-r3 f-ml5 f-size13">获取验证码</span> <span
											class="ie8 icon-close close hide" style="right: 130px"></span>

										<label class="focus">请查收手机短信（此验证码5分钟内有效）</label> <label
											class="focus valid"></label>
									</div>
								</div>
								<div class="item col-xs-12">
									<div class=" intelligent-label f-fl">
										<h5>
											<b>绑定邮箱</b>
										</h5>
									</div>

									<div class="f-fl item-ifo">
										<input type="text" class="txt03 f-r3 required" id="input-mail" />
										<!-- <input type="text" id="input-tel" class="txt03 f-r3 required" keycodes="tel" tabindex="2" data-valid="isNonEmpty||isPhone" data-error="手机号码不能为空||手机号码格式不正确" maxlength="11" id="phone" /> -->
										<span class="ie8 icon-close close hide"></span> <label
											class="icon-sucessfill blank hide" id="mail-suc">
											<div class="item col-xs-12" id="emailSendBtn"
												style="width: auto;">
												<div class="f-fl item-ifo">
													<span id="emailsaveIcon"
														class="btn btn-gray f-r3 f-ml5 f-size13"
														style="margin-left: 10px;">发送绑定激活邮件</span>
												</div>
											</div> <!--<span class="glyphicon glyphicon-ok-circle" aria-hidden="true"></span>-->
										</label> <label class="focus" id="mail-initial">绑定邮箱即可通过邮件接收考试信息</label>
										<label class="focus valid error" id="mail-empty" style="display:none;">邮箱不能修改为空</label>
										<label class="focus valid error" id="mail-error" style="display:none;">邮箱格式不正确</label>
										<label class="focus valid error" id="mail-msg" style="display:none;">邮箱等待绑定</label>
									</div>
								</div>

								<!--											<div class="alert alert-info" id="massege-sent" style="width: 700px; display: none">短信已发送至您手机，请输入短信中的验证码，确保您的手机号真实有效。</div>
-->

							</div>

						</div>
					</div>
				</div>
				<!-- 内容结束 -->

			</div>
			<!-- 内容容器结束 -->

		</div>

		<!-- 右边通讯录滑页 -->
		<div class="side-bar right-bar nicescroll">
			<h4 class="text-center">通讯录</h4>
			<div class="contact-list nicescroll">
				<ul class="list-group contacts-list">
					<li class="list-group-item"><a href="#">
							<div class="avatar">
								<img src="../../img/users/avatar-1.jpg"
									th:src="@{static/img/users/avatar-1.jpg}" alt="">
							</div> <span class="name">郭力源</span> <i class="fa fa-circle online"></i>
					</a> <span class="clearfix"></span></li>
					<li class="list-group-item"><a href="#">
							<div class="avatar">
								<img src="../../img/users/avatar-2.jpg"
									th:src="@{static/img/users/avatar-2.jpg}" alt="">
							</div> <span class="name">郑娇</span> <i class="fa fa-circle online"></i>
					</a> <span class="clearfix"></span></li>

				</ul>
			</div>
		</div>
		<!-- 滑页结束 -->

	</div>
	<!-- 页面结束 -->
	<!--图片裁剪框 start-->
	<div style="display: none" class="tailoring-container">
		<div class="black-cloth" onClick="closeTailor(this)"></div>
		<div class="tailoring-content">
			<div class="tailoring-content-one">
				<label id="imageKTitle">上传头像</label>
				<div class="close-tailoring" onclick="closeTailor(this)">×</div>
			</div>
			<div class="tailoring-content-two">
				<div class="tailoring-box-parcel">
					<img id="tailoringImg">
				</div>
				<div class="preview-box-parcel">

					<!-- <div class="square previewImg"></div> -->
					<center>
						<div class="circular previewImg"></div>
						<p>
							图片预览<br />108px × 108px
						</p>
						<br /> <label title="上传图片" for="chooseImg"
							class="l-btn choose-btn"> <input type="file"
							accept="image/jpg,image/jpeg,image/png" name="file"
							id="chooseImg" class="hidden" onChange="selectImg(this)" /> 选择图片
						</label>
					</center>
				</div>
			</div>
			<div class="tailoring-content-three">
				<button class="l-btn cropper-reset-btn">复位</button>
				<button class="l-btn cropper-rotate-btn">旋转</button>
				<button class="l-btn cropper-scaleX-btn">换向</button>
				<button class="l-btn sureCut" id="sureCut">确认上传</button>
			</div>
		</div>
	</div>
	<!--图片裁剪框 end-->
	<!-- Main  -->

	<!--警告提示框-->
	<div class="alert"></div>

	<script src="../../js/bootstrap.min.js"
		th:src="@{static/js/bootstrap.min.js}"></script>
	<script src="../../js/fastclick.js" th:src="@{static/js/fastclick.js}"></script>
	<script src="../../js/waves.js" th:src="@{static/js/waves.js}"></script>
	<script src="../../js/wow.min.js" th:src="@{static/js/wow.min.js}"></script>
	<script src="../../js/jquery.nicescroll.js"
		th:src="@{static/js/jquery.nicescroll.js}"></script>
	<script src="../../js/jquery.scrollTo.min.js"
		th:src="@{static/js/jquery.scrollTo.min.js}"></script>
	<script src="../../js/jquery.app.js"
		th:src="@{static/js/jquery.app.js}"></script>

	<script type="text/javascript" src="../../js/cropper.min.js"
		th:src="@{static/js/cropper.min.js}"></script>
	<script type="text/javascript">
			//弹出框水平垂直居中
			(window.onresize = function() {
				var win_height = $(window).height();
				var win_width = $(window).width();
				if(win_width <= 768) {
					$(".tailoring-content").css({
						"top": (win_height - $(".tailoring-content").outerHeight()) / 2,
						"left": 0
					});
				} else {
					$(".tailoring-content").css({
						"top": (win_height - $(".tailoring-content").outerHeight()) / 2,
						"left": (win_width - $(".tailoring-content").outerWidth()) / 2
					});
				}
			})();

			//弹出图片裁剪框
			/*    $("#replaceImg").on("click",function () {
			       $(".tailoring-container").toggle();
			   }); */
			//图像上传
			function selectImgupload(file) {
				$(".tailoring-container").toggle();
				if(!file.files || !file.files[0]) {
					return;
				}
				var reader = new FileReader();
				reader.onload = function(evt) {
					var replaceSrc = evt.target.result;
					//更换cropper的图片
					$('#tailoringImg').cropper('replace', replaceSrc, false); //默认false，适应高度，不失真
				}
				reader.readAsDataURL(file.files[0]);
			}
			//图像上传
			function selectImg(file) {
				if(!file.files || !file.files[0]) {
					return;
				}
				var reader = new FileReader();
				reader.onload = function(evt) {
					var replaceSrc = evt.target.result;
					//更换cropper的图片
					$('#tailoringImg').cropper('replace', replaceSrc, false); //默认false，适应高度，不失真
				}
				reader.readAsDataURL(file.files[0]);
			};
			//cropper图片裁剪
			$('#tailoringImg').cropper({
				aspectRatio: 1 / 1, //默认比例
				preview: '.previewImg', //预览视图
				guides: false, //裁剪框的虚线(九宫格)
				autoCropArea: 0.5, //0-1之间的数值，定义自动剪裁区域的大小，默认0.8
				movable: false, //是否允许移动图片
				dragCrop: true, //是否允许移除当前的剪裁框，并通过拖动来新建一个剪裁框区域
				movable: true, //是否允许移动剪裁框
				resizable: true, //是否允许改变裁剪框的大小
				zoomable: false, //是否允许缩放图片大小
				mouseWheelZoom: false, //是否允许通过鼠标滚轮来缩放图片
				touchDragZoom: true, //是否允许通过触摸移动来缩放图片
				rotatable: true, //是否允许旋转图片
				crop: function(e) {
					// 输出结果数据裁剪图像。
				}
			});
			//旋转
			$(".cropper-rotate-btn").on("click", function() {
				$('#tailoringImg').cropper("rotate", 45);
			});
			//复位
			$(".cropper-reset-btn").on("click", function() {
				$('#tailoringImg').cropper("reset");
			});
			//换向
			var flagX = true;
			$(".cropper-scaleX-btn").on("click", function() {
				if(flagX) {
					$('#tailoringImg').cropper("scaleX", -1);
					flagX = false;
				} else {
					$('#tailoringImg').cropper("scaleX", 1);
					flagX = true;
				}
				flagX != flagX;
			});

			//裁剪后的处理
			$("#sureCut").on("click", function() {
				if($("#tailoringImg").attr("src") == null) {
					return false;
				} else {
					var cas = $('#tailoringImg').cropper('getCroppedCanvas'); //获取被裁剪后的canvas
					var base64url = cas.toDataURL('image/png'); //转换为base64地址形式
					$("#finalImg").prop("src", base64url); //显示为图片的形式
					var start = base64url.indexOf('base64,') + 7;
					base64url = base64url.substring(start, base64url.length);
					base64url = base64url.replace(/\+/g, "%2B");

					$.ajax({
						contentType: "application/x-www-form-urlencoded; charset=utf-8",
						type: "post",
						url: "uploadUserAuatarImg",
						data: {
							image: base64url
						},
						dataType: 'text',
						success: function(res) {
							//console.log(res);
							var data = JSON.parse(res);
							if(data.flag == '0000') {
								$('.alert').html('头像上传成功').addClass('alert-success').show().delay(1000).fadeOut();
							}
						}
					})
					//关闭裁剪框
					closeTailor();
				}
			});
			//关闭裁剪框
			function closeTailor() {
				$(".tailoring-container").toggle();
			}
		</script>

	<script>
			var resizefunc = [];
			//用户名
			var username = $('#adminNo').val();
			//用户手机
			var usertel = $('#input-tel').val();
			//发送验证码
			var validCode = true;
			//用户邮箱
			var usermail=$("#input-mail").val();
			var t;
			function sendMsg() {
				var telnumber = $("#input-tel").val();
				$.ajax({
					url: "changeSendMsg/" + telnumber,
					async: true,
					type: "get",
					//  dataType: "json",
					success: function(data) {
						//alert(data);
						if(data.code == '2000') {
							$('.alert').html('发送验证码失败').addClass('alert-danger').show().delay(1000).fadeOut();
							return;
						}
						if(data.code == '0000') {
							//alert("发送成功");
							var time = 30;
							var code = $(".msgs");
							if(validCode) {
								validCode = false;
								code.addClass("msgs1");
								t = setInterval(function() {
									time--;
									code.html(time + "s后重新发送");
									
									if(time==0) {
										clearInterval(t);
										code.html("重新获取");
										validCode = true;
										code.removeClass("msgs1");

									}
								}, 1000)
							}
						}
					}
				})
			}

			$(function() {
				$('#upload-userPhoto').mouseover(function() {

					$('.photo-mask').css("opacity", "0.5");

				});
				$('#upload-userPhoto').mouseout(function() {

					$('.photo-mask').css('opacity', '0');

				});

				$('#rightSend').click(function() {
					if($("#input-tel").prop('disabled')){
						$('#rightSend span').text('确认发送验证码');
						$("#input-tel").removeAttr("disabled");;
						$('#verifydiv').hide();
					}else{
						$('#rightSend span').text('更换手机号');
						validCode=true;
					$("#input-tel").attr("disabled","disabled");
					clearInterval(t);
					$('#verifydiv').show();				
					sendMsg();
					}
				})
	
				//获取短信验证码

				$(".item-ifo").on('click', '.msgs', function() {
					sendMsg();
				});
				//更新保存用户名
				$('#namesaveIcon').click(function() {
					var name = $("#adminNo").val();
					$.ajax({
						url: "changeUsername",
						async: true,
						type: "post",
						data: {
							"name": name
						},
						//  dataType: "json",
						success: function(data) {
							//alert(data);
							if(data.code == '0000') {
								$('#namesaveIcon').parent().addClass('hide');
								username = name;
								$('.alert').html('用户名修改成功').addClass('alert-success').show().delay(1000).fadeOut();

							}
						}
					})
				})
				$('#namenosaveIcon').click(function() {
					$(this).parent().addClass('hide');
					$('#adminNo').val(username);
				})
				
				//提交验证码
				$('#verifysaveIcon').click(function() {
					var verifyCode = $("#verifyNo").val();
					var telnumber = $("#input-tel").val();
					$.ajax({
						url: "changeTel",
						async: true,
						type: "post",
						data: {
							"verifyCode": verifyCode,
							"tel":telnumber
						},
						//  dataType: "json",
						success: function(data) {
							//alert(data);
							if (data.code == '2001') {
							$('.alert').html('验证码错误').addClass('alert-danger').show().delay(1000).fadeOut();
							return false;
						} else if (data.code == '2002') {
							$('.alert').html('验证码过期请重新获取验证码').addClass('alert-warning').show().delay(1000).fadeOut();
							return false;
						}else if(data.code == '0000') {
								$('#namesaveIcon').parent().addClass('hide');
								usertel = telnumber;
								$('.alert').html('手机修改成功').addClass('alert-success').show().delay(1000).fadeOut();

							}
						}
					})
				})
				//取消验证码
				$('#verifynosaveIcon').click(function() {
					$(this).parent().addClass('hide');
					$('#verifyNo').val('');
				})
				
				//用户名是否未作修改
				$('#adminNo').blur(function() {
					var name = $("#adminNo").val();
					if(name == username) {
						$('.alert').html('用户名未做修改').addClass('alert-info').show().delay(1000).fadeOut();
						$('#namesaveIcon').parent().addClass('hide');
					}
				})
				//手机号是否重复
				$('#input-tel').blur(function() {
					var telnumber = $("#input-tel").val();
					//每次刷新session
					//	alert(telnumber);
					if(telnumber.length == 11) {
						if(telnumber == usertel) {
							$('.alert').html('手机号未做修改').addClass('alert-info').show().delay(1000).fadeOut();
							$('#rightSend').parent().addClass('hide');
						} else {
							$.ajax({
								url: "registerChecktel/" + telnumber,
								async: true,
								type: "post",
								// dataType: "json",
								success: function(data) {
									if(data.code == '1002') {
										$('#input-tel~label').eq(0).addClass('hide');
										$('#input-tel~label').eq(2).addClass('error');
										$('#input-tel~label').eq(2).text('该手机号已被注册');
									} else if(data.code == '0000') {
										$('#input-tel+label').removeClass('hide');
									}
								}
							})
						}
					}
				})
				//获取邮箱
				$('#input-mail').blur(function(){
					
					var mail=$('#input-mail').val();
					if(mail==''){
						//alert(1);
						$("#mail-empty").removeClass("hide");
						$("#mail-initial").css("display","none");
						$("#mail-empty").css("display","inline-block");
					}
					//alert(mail);
					 var reg = /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;
                     isok= reg.test(mail );
                     if (!isok) {
                    	
 						$("#mail-initial").css("display","none");
 						$("#mail-error").removeClass("hide");
 						$("#mail-error").css("display","inline-block");  
                     }else{
                    	 $("#mail-initial").css("display","none");
                    	 $("#mail-suc").removeClass("hide");
                     }
				})
				//提交邮箱
				$('#mail-suc').click(function(){
					var mail=$('#input-mail').val();
					alert(mail);
					$.ajax({
						url: "sendMail",
						async: true,
						type: "post",
						data: {
							"mail":mail
						},
						//  dataType: "json",
						success: function(data) {
							//alert(data);
							 if (data.code == '1001') {
							$('.alert').html('验证码错误').addClass('alert-danger').show().delay(1000).fadeOut();
							return false;
						} else if(data.code == '0000') {
								$('.alert').html('邮件发送成功！请去邮箱验证绑定！').addClass('alert-success').show().delay(1000).fadeOut();
								$("#mail-msg").removeClass("hide");
		 						$("#mail-msg").css("display","inline-block");  
							} 
						}
					})
				})
			})
		</script>

</body>

</html>